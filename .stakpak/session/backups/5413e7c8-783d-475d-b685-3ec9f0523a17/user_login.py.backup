# ./lmrex/components/user_login.py

import reflex as rx

from ..state.auth_state import AuthState


class LoginState(rx.State):
    username: str = ""
    password: str = ""


def user_login() -> rx.Component:
    return rx.dialog.root(
        rx.dialog.title(rx.dialog.trigger(rx.button("Login"))),
        rx.dialog.content(
            rx.heading("Sign-in or Register", size="6"),
            rx.text("Enter your credentials below."),
            rx.form(
                rx.input(
                    placeholder="Username",
                    on_change=LoginState.set_username,
                    value=LoginState.username,
                ),
                rx.input(
                    placeholder="Password",
                    type="password",
                    on_change=LoginState.set_password,
                    value=LoginState.password,
                ),
            ),
            rx.dialog.close(
                rx.button(
                    "Submit",
                    on_click=lambda: AuthState.handle_login_success(
                        LoginState.password, redirect=True
                    ),
                )
            ),
            rx.spacer(column=1),
            rx.dialog.trigger(rx.button("Create Account")),
        ),
    )
